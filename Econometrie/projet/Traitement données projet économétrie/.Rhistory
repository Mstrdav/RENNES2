outlier.colour = "salmon", outlier.size = 4, notch = TRUE,
notchwidth = 0.9
) +
labs(y = nomsdevar[i-1], x = nomsboxplots[j])
theme_minimal()
box_plots[[j]] <- p
j <- j + 1
}
# nombre de colonnes voulu
ncol_plot <- 3
do.call(grid.arrange, c(box_plots, ncol = ncol_plot))
histosssingapour = ggplot(data_numeric, aes_string(x = data_numeric$Population_Density)) +
geom_histogram(binwidth = diff(range(data_numeric[[6]])) / 20, fill = "salmon1", color = "white", alpha = 0.7) +
labs(x = "Fréquence" , y = nomsdevar[6]) +
theme_minimal() +
theme(plot.margin = grid::unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
histosssingapour = ggplot(data_numeric, aes_string(x = data_numeric$Population_Density)) +
geom_histogram(binwidth = diff(range(data_numeric[[6]])) / 20, fill = "salmon1", color = "white", alpha = 0.7) +
labs(x = "Fréquence" , y = nomsdevar[6]) +
theme_minimal() +
theme(plot.margin = grid::unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
do.call(grid.arrange, c(plots[c(2, 6, 7, histosssingapour)], ncol = 2))
do.call(grid.arrange, c(c(plots[c(2, 6, 7)], histosssingapour), ncol = 2))
data_numericsssingapour = data_numeric[-"Singapore",]
data_numericsssingapour = data_numeric - data_numeric["Singapore",]
data_numericsssingapour = data_numeric[-c("Singapore"),]
data_ss_singapour <- data[-which(data$Code == "SGP"), ]
histosssingapour = ggplot(data_ss_singapour, aes_string(x = data_ss_singapour$Population_Density)) +
geom_histogram(binwidth = diff(range(data_ss_singapour[[6]])) / 20, fill = "blue", color = "white", alpha = 0.7) +
labs(x = "Fréquence" , y = nomsdevar[6]) +
theme_minimal() +
theme(plot.margin = grid::unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
do.call(grid.arrange, c(c(plots[c(2, 6, 7)], histosssingapour), ncol = 2))
View(data_ss_singapour)
histosssingapour = ggplot(data_ss_singapour, aes_string(x = data_ss_singapour$Population_Density)) +
geom_histogram(binwidth = diff(range(data_ss_singapour$Population_Density)) / 20, fill = "blue", color = "white", alpha = 0.7) +
labs(x = "Fréquence" , y = nomsdevar[6]) +
theme_minimal() +
theme(plot.margin = grid::unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
do.call(grid.arrange, c(c(plots[c(2, 6, 7)], histosssingapour), ncol = 2))
data_ss_singapour <- data[-which(data$Code == "SGP"), ]
View(data_ss_singapour)
histosssingapour = ggplot(data_ss_singapour, aes_string(x = data_ss_singapour$Population_Density)) +
geom_histogram(binwidth = diff(range(data_ss_singapour$Population_Density)) / 20, fill = "blue", color = "white", alpha = 0.7) +
labs(x = "Fréquence sans Singapour" , y = nomsdevar[6]) +
theme_minimal() +
theme(plot.margin = grid::unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
do.call(grid.arrange, c(c(plots[c(2, 6, 7)], histosssingapour), ncol = 2))
plots <- list()
nomsdevar = c("Corruption politique", "PIB par habitant", "Espérance de vie", "Migration nette", "Surpoids", "Densité de population", "Consommation énergétique", "Dépenses militaires", "Croissance de population", "Inscriptions à l'école primaire")
numerohistogramme = c("Histogramme n°8","Histogramme n°5","Histogramme n°9","Histogramme n°1","Histogramme n°10","Histogramme n°6","Histogramme n°7","Histogramme n°2","Histogramme n°3","Histogramme n°4",)
plots <- list()
nomsdevar = c("Corruption politique", "PIB par habitant", "Espérance de vie", "Migration nette", "Surpoids", "Densité de population", "Consommation énergétique", "Dépenses militaires", "Croissance de population", "Inscriptions à l'école primaire")
numerohistogramme = c("Histogramme n°8","Histogramme n°5","Histogramme n°9","Histogramme n°1","Histogramme n°10","Histogramme n°6","Histogramme n°7","Histogramme n°2","Histogramme n°3","Histogramme n°4")
for (i in 1:ncol(data_numeric)) {
p <- ggplot(data_numeric, aes_string(x = data_numeric[[i]])) +
geom_histogram(binwidth = diff(range(data_numeric[[i]])) / 20, fill = "salmon1", color = "white", alpha = 0.7) +
labs(x = numerohistogramme[i] , y = nomsdevar[i]) +
theme_minimal() +
theme(plot.margin = grid::unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
plots[[i]] <- p
}
plots <- plots[-11]
do.call(grid.arrange, c(plots[c(4, 8, 9, 10)], ncol = 2))
data_ss_singapour <- data[-which(data$Code == "SGP"), ]
histosssingapour = ggplot(data_ss_singapour, aes_string(x = data_ss_singapour$Population_Density)) +
geom_histogram(binwidth = diff(range(data_ss_singapour$Population_Density)) / 20, fill = "lightblue", color = "white", alpha = 0.7) +
labs(x = "Histogramme n°6b" , y = nomsdevar[6]) +
theme_minimal() +
theme(plot.margin = grid::unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
do.call(grid.arrange, c(c(plots[c(2, 6, 7)], histosssingapour), ncol = 2))
do.call(grid.arrange, c(plots[c(1, 3, 5)], ncol = 2))
plots <- list()
nomsdevar = c("Corruption politique", "PIB par habitant", "Espérance de vie", "Migration nette", "Surpoids", "Densité de population", "Consommation énergétique", "Dépenses militaires", "Croissance de population", "Inscriptions à l'école primaire")
numerohistogramme = c("Histogramme n°8","Histogramme n°5","Histogramme n°9","Histogramme n°1","Histogramme n°10","Histogramme n°6","Histogramme n°7","Histogramme n°2","Histogramme n°3","Histogramme n°4")
for (i in 1:ncol(data_numeric)) {
p <- ggplot(data_numeric, aes_string(x = data_numeric[[i]])) +
geom_histogram(binwidth = diff(range(data_numeric[[i]])) / 20, fill = "salmon1", color = "red", alpha = 0.7) +
labs(x = numerohistogramme[i] , y = nomsdevar[i]) +
theme_minimal() +
theme(plot.margin = grid::unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
plots[[i]] <- p
}
plots <- plots[-11]
do.call(grid.arrange, c(plots[c(4, 8, 9, 10)], ncol = 2))
data_ss_singapour <- data[-which(data$Code == "SGP"), ]
histosssingapour = ggplot(data_ss_singapour, aes_string(x = data_ss_singapour$Population_Density)) +
geom_histogram(binwidth = diff(range(data_ss_singapour$Population_Density)) / 20, fill = "lightblue", color = "blue", alpha = 0.7) +
labs(x = "Histogramme n°6b" , y = nomsdevar[6]) +
theme_minimal() +
theme(plot.margin = grid::unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
do.call(grid.arrange, c(c(plots[c(2, 6, 7)], histosssingapour), ncol = 2))
do.call(grid.arrange, c(plots[c(1, 3, 5)], ncol = 2))
knitr::opts_chunk$set(cache = TRUE) # Activer le cache des chunks pour accélérer les recompilations
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
options("install.lock" = FALSE) # Désactiver le verrouillage d’installation des packages
library(pastecs)
library(stargazer)
library(psych)
library(ggplot2)
library(car)
library(lmtest)
library(sandwich)
library(corrplot)
library(olsrr) # graohique des résidus
library(gridExtra)
library(tidyverse)
Pays_perdus <- as.data.frame(read.csv(file = "Pays_perdus.csv")[, -1])
names(Pays_perdus) = c("Pays_perdus","OCDE")
View(Pays_perdus)
stargazer(Pays_perdus,
type = "text",
summary = FALSE
)
# import des données
data <- read.csv(file = "donnees.csv", row.names = 2)[, -1] # pour enlever la colonne "numero"
# transform OCDE variable into factor
data$OCDE <- as.factor(data$OCDE) #32 OCDE 93 non membres
# Etude des statistiques descriptives
data_numeric <- data[, sapply(data, is.numeric)]
stargazer(data_numeric,
type = "text", digits = 2,
summary.stat = c("mean", "sd", "min", "median", "max")
)
# histogramme de la variable cible
ggplot(data, aes(x = Happiness)) +
geom_histogram(binwidth = 0.25, fill = "salmon1", color = "white", alpha = 0.7) +
labs(y = "Score de bonheur", x = "Fréquence") +
theme_minimal()
# boxplot de la variable cible
ggplot(data, aes(y = Happiness)) +
stat_boxplot(geom='errorbar', linetype=1, width=0.2) +
geom_boxplot(fill = "salmon1", color = "black", alpha = 0.7) +
labs(y = "Score de bonheur", x  = "")
plots <- list()
nomsdevar = c("Corruption politique", "PIB par habitant", "Espérance de vie", "Migration nette", "Surpoids", "Densité de population", "Consommation énergétique", "Dépenses militaires", "Croissance de population", "Inscriptions à l'école primaire")
numerohistogramme = c("Histogramme n°8","Histogramme n°5","Histogramme n°9","Histogramme n°1","Histogramme n°10","Histogramme n°6","Histogramme n°7","Histogramme n°2","Histogramme n°3","Histogramme n°4")
for (i in 1:ncol(data_numeric)) {
p <- ggplot(data_numeric, aes_string(x = data_numeric[[i]])) +
geom_histogram(binwidth = diff(range(data_numeric[[i]])) / 20, fill = "salmon1", color = "red", alpha = 0.7) +
labs(x = numerohistogramme[i] , y = nomsdevar[i]) +
theme_minimal() +
theme(plot.margin = grid::unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
plots[[i]] <- p
}
plots <- plots[-11]
do.call(grid.arrange, c(plots[c(4, 8, 9, 10)], ncol = 2))
data_ss_singapour <- data[-which(data$Code == "SGP"), ]
histosssingapour = ggplot(data_ss_singapour, aes_string(x = data_ss_singapour$Population_Density)) +
geom_histogram(binwidth = diff(range(data_ss_singapour$Population_Density)) / 20, fill = "lightblue", color = "blue", alpha = 0.7) +
labs(x = "Histogramme n°6b" , y = nomsdevar[6]) +
theme_minimal() +
theme(plot.margin = grid::unit(c(0.5, 0.5, 0.5, 0.5), "cm"))
do.call(grid.arrange, c(c(plots[c(2, 6, 7)], histosssingapour), ncol = 2))
do.call(grid.arrange, c(plots[c(1, 3, 5)], ncol = 2))
nomsboxplots = c("Boxplot n°1","Boxplot n°2","Boxplot n°3","Boxplot n°4","Boxplot n°5","Boxplot n°6")
box_plots <- list()
j <- 1
for (i in c(2, 3, 5, 7, 11,9)) {
p <- ggplot(data, aes_string(y = data[[i]])) +
stat_boxplot(geom='errorbar', linetype=1, width=0.2, color = "blue") +
geom_boxplot(
color =  'blue',fill = 'lightblue',
outlier.colour = "salmon", outlier.size = 4, notch = TRUE,
notchwidth = 0.9
) +
labs(y = nomsdevar[i-1], x = nomsboxplots[j])
theme_minimal()
box_plots[[j]] <- p
j <- j + 1
}
# nombre de colonnes voulu
ncol_plot <- 3
do.call(grid.arrange, c(box_plots, ncol = ncol_plot))
# Corrélations simples et affichage graphique (base R)
vars <- names(data_numeric)[-ncol(data_numeric)]
cors <- sapply(vars, function(v) cor(data_numeric$Happiness, data_numeric[[v]]))
# trier par valeur (pour barplot horizontal)
names(cors) = nomsdevar
cors_sorted <- sort(cors)
par(mar=c(4,12,4.1,1))
barplot(cors_sorted,
horiz = TRUE, las = 1,
# bicolor
col = ifelse(cors_sorted > 0, "lightblue", "salmon1"),
main = "Corrélations des variables avec l'indice de bonheur",
)
# Tracé des graphes de points et de la linéarité
scatter_plots <- list()
for (i in 2:11) {
p <- ggplot(data, aes_string(x = data[[i]], y = "Happiness")) +
geom_point() +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue", se = TRUE) +
labs(x = nomsdevar[i-1], y = "Indice de bonheur") +
theme_minimal()
scatter_plots[[i - 1]] <- p
}
do.call(grid.arrange, c(scatter_plots[c(3)], ncol = 1))
do.call(grid.arrange, c(scatter_plots[c(1,5,9,8)], ncol = 2))
data_ss_singapour <- data[-which(data$Code == "SGP"), ]
sspopplot <- ggplot(data_ss_singapour, aes_string(x = "Population_Density", y = "Happiness")) +
geom_point(color = "blue") +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue", se = TRUE) +
labs(x = "Sans Singapour", y = "Indice de bonheur") +
theme_minimal()
data_ss_somalie <- data[-which(data$Code == "SOM"), ]
ssschoolplot <- ggplot(data_ss_somalie, aes_string(x = "Primary_School_Enrollment", y = "Happiness")) +
geom_point(color = "blue") +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue", se = TRUE) +
labs(x = "Sans la Somalie", y = "Indice de bonheur") +
theme_minimal()
data_ss_pak_usa <- data[-which(data$Code == "PAK" | data$Code == "USA"), ]
ssmigrationplot <- ggplot(data_ss_pak_usa, aes_string(x = "Net_Migration", y = "Happiness")) +
geom_point(color = "blue") +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue", se = TRUE) +
labs(x = "Sans les USA ni le Pakistan", y = "Indice de bonheur") +
theme_minimal()
outlierplots <- list(ssmigrationplot, sspopplot, ssschoolplot)
scatter_migration = ggplot(data, aes_string(x = data$Net_Migration, y = "Happiness")) +
geom_point() +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue",
se = TRUE) +
labs(x = nomsdevar[4], y = "Indice de bonheur") +
geom_label(label="Pakistan", x=-1250000,y=5.9)+
geom_label(label="USA", x=1050000,y=6)+
theme_minimal()
scatter_densite = ggplot(data, aes_string(x = data$Population_Density, y = "Happiness")) +
geom_point() +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue",
se = TRUE) +
labs(x = nomsdevar[6], y = "Indice de bonheur") +
geom_label(label="Singapour", x=6600,y=7)+
theme_minimal()
scatter_ecole = ggplot(data, aes_string(x = data$Primary_School_Enrollment, y = "Happiness")) +
geom_point() +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue",
se = TRUE) +
labs(x = nomsdevar[10], y = "Indice de bonheur") +
geom_label(label="Somalie", x=23,y=5.5)+
theme_minimal()
aberrant_plots = c(scatter_migration, scatter_densite, scatter_ecole,outlierplots)
do.call(grid.arrange, c(aberrant_plots, ncol = 3))
data_PIB_log <- data
data_PIB_log$GDP_per_Capita <- log(data_PIB_log$GDP_per_Capita)
PIBplot <- ggplot(data_PIB_log, aes_string(x = "GDP_per_Capita", y = "Happiness")) +
geom_point(color = "blue") +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue", se = TRUE) +
labs(x = "Logarithme du PIB par habitant", y = "Indice de bonheur") +
theme_minimal()
data_KWH_log <- data
data_KWH_log$KWH_pp_pc <- log(data_KWH_log$KWH_pp_pc)
KWHplot <- ggplot(data_KWH_log, aes_string(x = "KWH_pp_pc", y = "Happiness")) +
geom_point(color = "blue") +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue", se = TRUE) +
labs(x = "Logarithme de la consommmation énergétique", y = "Indice de bonheur") +
theme_minimal()
data_migration <- data
data_migration$Net_Migration <- log(data_migration$Net_Migration)
migrationplot <- ggplot(data_migration, aes_string(x = "Net_Migration", y = "Happiness")) +
geom_point() +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue", se = TRUE) +
labs(x = "Logarithme de la migration", y = "Indice de bonheur") +
theme_minimal()
logplots <- list(PIBplot, KWHplot, migrationplot)
do.call(grid.arrange, c(scatter_plots[c(2,7)],logplots[c(1,2)], ncol = 2))
ggplot(data, aes(x = OCDE, y = Happiness)) +
stat_boxplot(geom='errorbar', linetype=1, width=0.2,
color ="blue")+
geom_boxplot(color =  'blue',fill = c("salmon","lightblue"), alpha = 0.7,
outlier.colour = "salmon", outlier.size = 4, notch = TRUE,
notchwidth = 0.9) +
labs(x = "Appartenance à l'OCDE", y = "Indice de bonheur") +
theme_minimal() +
scale_x_discrete(labels = c("93 non-membres", '32 membres'))
# premier modèle : toutes les variables candidates
reglin <- lm(Happiness ~ Political_Corruption + KWH_pp_pc + GDP_per_Capita + Lifespan + Net_Migration + Overweight_Adults + Population_Density + Military_Expenses + Population_Growth + OCDE + Primary_School_Enrollment, data = data)
reglog <- lm(Happiness ~ Political_Corruption + log(KWH_pp_pc) + log(GDP_per_Capita) + Lifespan + Net_Migration + Overweight_Adults + Population_Density + Military_Expenses + Population_Growth + OCDE + Primary_School_Enrollment, data = data)
stargazer(reglin, reglog, type = "text", digits = 2,  single.row = TRUE)
# Calcul du VIF initial
vif_values <- vif(reglog)
vif_df <- data.frame(Variable = names(vif_values), VIF = as.numeric(vif_values))
stargazer(vif_df, type = "text", summary = FALSE, rownames = FALSE, digits = 2)
# Modèle corrigé : suppression de KWH_pp_pc
reg_vif_clean <- lm(Happiness ~ Political_Corruption + log(GDP_per_Capita) + Lifespan + Net_Migration + Overweight_Adults + Population_Density + Military_Expenses + Population_Growth + OCDE + Primary_School_Enrollment, data = data)
# Nouveau VIF de contrôle
vif_values_clean <- vif(reg_vif_clean)
vif_df_clean <- data.frame(Variable = names(vif_values_clean), VIF = as.numeric(vif_values_clean))
stargazer(vif_df_clean, type = "text", summary = FALSE, rownames = FALSE, digits = 2)
# Sélection backward
reg_final_step <- step(reg_vif_clean, direction = "backward", trace = 0)
stargazer(reg_final_step, type = "text", digits = 3, single.row = TRUE)
# Ajout de l'interaction OCDE * log(GDP)
reg_interact <- update(reg_final_step, . ~ . + OCDE:log(GDP_per_Capita))
# Comparaison des modèles
stargazer(reg_final_step, reg_interact, type = "text", digits = 3,   single.row = TRUE)
# Test anova pour voir si l'interaction apporte significativement de l'information
bop = anova(reg_final_step, reg_interact)
cat("Modèle Final:
Happiness ~ Political_Corruption + log(GDP_per_Capita) + Lifespan + Overweight_Adults
+ Military_Expenses + Population_Growth + OCDE + Primary_School_Enrollment")
cat("Modèle avec Interaction :
Happiness ~ Political_Corruption + log(GDP_per_Capita) + Lifespan + Overweight_Adults
+ Military_Expenses + Population_Growth + OCDE + Primary_School_Enrollment
+ log(GDP_per_Capita)*OCDE")
stargazer(bop, type = "text",  digits = 3, summary = FALSE)
# Définition définitive du modèle final
best_model <- reg_final_step
# 1. Homoscédasticité (Breusch-Pagan)
bp_test <- bptest(best_model)
# 2. Normalité des résidus (Shapiro-Wilk)
shapiro_test <- shapiro.test(resid(best_model))
# 3. Autocorrélation (Durbin-Watson)
dw_test <- dwtest(best_model)
# Création d'un tableau récapitulatif
diag_df <- data.frame(
Test = c("Breusch-Pagan (Homoscédasticité)", "Shapiro-Wilk (Normalité)", "Durbin-Watson (Indépendance)"),
Statistique = c(round(bp_test$statistic, 3), round(shapiro_test$statistic, 3), round(dw_test$statistic, 3)),
P_Value = c(format(bp_test$p.value, digits = 4), format(shapiro_test$p.value, digits = 4), format(dw_test$p.value, digits = 4))
)
stargazer(diag_df, type = "text", summary = FALSE, rownames = FALSE,  digits = 4)
par(mfrow = c(1, 2))
plot(best_model, which = 1, main = "Résidus vs Ajustés") # Homoscédasticité
plot(best_model, which = 2, main = "Q-Q Plot") # Normalité
par(mfrow = c(1, 1))
par(mfrow = c(1, 2))
plot(best_model, which = 4, main = "Distance de Cook")
abline(0.03, 0, col = "red", lty = 2)
plot(best_model, which = 5, main = "Résidus vs Levier")
par(mfrow = c(1, 1))
# Affichage final du modèle
stargazer(best_model, type = "text",  digits = 3,  single.row = TRUE)
# histogramme de la variable cible
ggplot(data, aes(x = Happiness)) +
geom_histogram(binwidth = 0.25, fill = "salmon1", color = "red", alpha = 0.7) +
labs(y = "Score de bonheur", x = "Fréquence") +
theme_minimal()
# boxplot de la variable cible
ggplot(data, aes(y = Happiness)) +
stat_boxplot(geom='errorbar', linetype=1, width=0.2) +
geom_boxplot(fill = "lightblue", color = "blue", alpha = 0.7) +
labs(y = "Score de bonheur", x  = "")
x
print("x")
do.call(grid.arrange, c(plots[c(4, 8, 9, 10)], ncol = 2))
print("c")
do.call(grid.arrange, c(plots[c(1, 3, 5)], ncol = 2))
print("x")
do.call(grid.arrange, c(plots[c(1, 3, 5)], ncol = 2))
data_ss_singapour <- data[-which(data$Code == "SGP"), ]
sspopplot <- ggplot(data_ss_singapour, aes_string(x = "Population_Density", y = "Happiness")) +
geom_point(color = "purple4") +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue", se = TRUE) +
labs(x = "Sans Singapour", y = "Indice de bonheur") +
theme_minimal()
data_ss_somalie <- data[-which(data$Code == "SOM"), ]
ssschoolplot <- ggplot(data_ss_somalie, aes_string(x = "Primary_School_Enrollment", y = "Happiness")) +
geom_point(color = "purple4") +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue", se = TRUE) +
labs(x = "Sans la Somalie", y = "Indice de bonheur") +
theme_minimal()
data_ss_pak_usa <- data[-which(data$Code == "PAK" | data$Code == "USA"), ]
ssmigrationplot <- ggplot(data_ss_pak_usa, aes_string(x = "Net_Migration", y = "Happiness")) +
geom_point(color = "purple4") +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue", se = TRUE) +
labs(x = "Sans les USA ni le Pakistan", y = "Indice de bonheur") +
theme_minimal()
outlierplots <- list(ssmigrationplot, sspopplot, ssschoolplot)
scatter_migration = ggplot(data, aes_string(x = data$Net_Migration, y = "Happiness")) +
geom_point() +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue",
se = TRUE) +
labs(x = nomsdevar[4], y = "Indice de bonheur") +
geom_label(label="Pakistan", x=-1250000,y=5.9)+
geom_label(label="USA", x=1050000,y=6)+
theme_minimal()
scatter_densite = ggplot(data, aes_string(x = data$Population_Density, y = "Happiness")) +
geom_point() +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue",
se = TRUE) +
labs(x = nomsdevar[6], y = "Indice de bonheur") +
geom_label(label="Singapour", x=6600,y=7)+
theme_minimal()
scatter_ecole = ggplot(data, aes_string(x = data$Primary_School_Enrollment, y = "Happiness")) +
geom_point() +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue",
se = TRUE) +
labs(x = nomsdevar[10], y = "Indice de bonheur") +
geom_label(label="Somalie", x=23,y=5.5)+
theme_minimal()
aberrant_plots = c(scatter_migration, scatter_densite, scatter_ecole,outlierplots)
do.call(grid.arrange, c(aberrant_plots, ncol = 3))
data_ss_singapour <- data[-which(data$Code == "SGP"), ]
sspopplot <- ggplot(data_ss_singapour, aes_string(x = "Population_Density", y = "Happiness")) +
geom_point(color = "blue") +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue", se = TRUE) +
labs(x = "Sans Singapour", y = "Indice de bonheur") +
theme_minimal()
data_ss_somalie <- data[-which(data$Code == "SOM"), ]
ssschoolplot <- ggplot(data_ss_somalie, aes_string(x = "Primary_School_Enrollment", y = "Happiness")) +
geom_point(color = "blue") +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue", se = TRUE) +
labs(x = "Sans la Somalie", y = "Indice de bonheur") +
theme_minimal()
data_ss_pak_usa <- data[-which(data$Code == "PAK" | data$Code == "USA"), ]
ssmigrationplot <- ggplot(data_ss_pak_usa, aes_string(x = "Net_Migration", y = "Happiness")) +
geom_point(color = "blue") +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue", se = TRUE) +
labs(x = "Sans les USA ni le Pakistan", y = "Indice de bonheur") +
theme_minimal()
outlierplots <- list(ssmigrationplot, sspopplot, ssschoolplot)
scatter_migration = ggplot(data, aes_string(x = data$Net_Migration, y = "Happiness")) +
geom_point() +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue",
se = TRUE) +
labs(x = nomsdevar[4], y = "Indice de bonheur") +
geom_label(label="Pakistan", x=-1250000,y=5.9)+
geom_label(label="USA", x=1050000,y=6)+
theme_minimal()
scatter_densite = ggplot(data, aes_string(x = data$Population_Density, y = "Happiness")) +
geom_point() +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue",
se = TRUE) +
labs(x = nomsdevar[6], y = "Indice de bonheur") +
geom_label(label="Singapour", x=6600,y=7)+
theme_minimal()
scatter_ecole = ggplot(data, aes_string(x = data$Primary_School_Enrollment, y = "Happiness")) +
geom_point() +
geom_smooth(method = lm, color = "salmon1", fill = "lightblue",
se = TRUE) +
labs(x = nomsdevar[10], y = "Indice de bonheur") +
geom_label(label="Somalie", x=23,y=5.5)+
theme_minimal()
aberrant_plots = c(scatter_migration, scatter_densite, scatter_ecole,outlierplots)
do.call(grid.arrange, c(aberrant_plots, ncol = 3))
# Ajout de l'interaction OCDE * log(GDP)
reg_interact <- update(reg_final_step, . ~ . + OCDE*log(GDP_per_Capita))
# Comparaison des modèles
stargazer(reg_final_step, reg_interact, type = "text", digits = 3,   single.row = TRUE)
# Test anova pour voir si l'interaction apporte significativement de l'information
bop = anova(reg_final_step, reg_interact)
cat("Modèle Final:
Happiness ~ Political_Corruption + log(GDP_per_Capita) + Lifespan + Overweight_Adults
+ Military_Expenses + Population_Growth + OCDE + Primary_School_Enrollment")
cat("Modèle avec Interaction :
Happiness ~ Political_Corruption + log(GDP_per_Capita) + Lifespan + Overweight_Adults
+ Military_Expenses + Population_Growth + OCDE + Primary_School_Enrollment
+ log(GDP_per_Capita)*OCDE")
stargazer(bop, type = "text",  digits = 3, summary = FALSE)
plot(best_model, which = 1, main = "Résidus vs Ajustés", colors = "Lightblue") # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "Lightblue") # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "salmon") # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "blue", ) # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "blue", fill = "lightblue") # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "blue", fill = "lightblue", pch = 19) # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "blue", fill = "lightblue", pch = 1) # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "blue", fill = "lightblue", pch = 2) # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "blue", fill = "lightblue", pch = 3) # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "blue", fill = "lightblue", pch = 4) # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "blue", fill = "lightblue", pch = 5) # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "blue", fill = "lightblue", pch = 6) # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "blue", fill = "lightblue", pch = 7) # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "blue", fill = "lightblue", pch = 8) # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "blue", fill = "lightblue", pch = 9) # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "blue", fill = "lightblue", pch = 10) # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "blue", fill = "lightblue", pch = 11) # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "blue", fill = "lightblue", pch = 12) # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "blue", fill = "lightblue", pch = 13) # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "blue", fill = "lightblue", pch = 19) # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "blue", fill = "lightblue", pch = 18) # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = c("blue",'lightblue'), pch = 19) # Homoscédasticité
par(mfrow = c(1, 2))
plot(best_model, which = 1, main = "Résidus vs Ajustés", rgb(0, 0, 0, 0.15), pch = 19) # Homoscédasticité
plot(best_model, which = 2, main = "Q-Q Plot") # Normalité
par(mfrow = c(1, 1))
plot(best_model, which = 1, main = "Résidus vs Ajustés", rgb(0, 0, 0, 0.15), pch = 19) # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", rgb(0, 0, 0, 0), pch = 19) # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", rgb(1, 0, 0, 0), pch = 19) # Homoscédasticité
plot(best_model, which = 1, main = "Résidus vs Ajustés", rgb(2, 0, 0, 0), pch = 19)
plot(best_model, which = 1, main = "Résidus vs Ajustés", rgb(2, 0, 0, 0), pch = 19)
plot(best_model, which = 1, main = "Résidus vs Ajustés", rgb(1, 0, 0, 0), pch = 19)
plot(best_model, which = 1, main = "Résidus vs Ajustés", rgb(1, 1, 1, 1), pch = 19)
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "blue", pch = 1)
# Homoscédasticité
plot(best_model, which = 2, main = "Q-Q Plot") # Normalité
# Homoscédasticité
plot(best_model, which = 2, main = "Q-Q Plot", col = 'red') # Normalité
par(mfrow = c(1, 2))
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "blue", pch = 1)
# Homoscédasticité
plot(best_model, which = 2, main = "Q-Q Plot", col = 'red') # Normalité
par(mfrow = c(1, 1))
# Homoscédasticité
plot(best_model, which = 2, main = "Q-Q Plot", col = 'red',  pch = 5) # Normalité
# Homoscédasticité
plot(best_model, which = 2, main = "Q-Q Plot", col = 'red',  pch = 4) # Normalité
par(mfrow = c(1, 2))
plot(best_model, which = 1, main = "Résidus vs Ajustés", col = "blue", pch = 1)
# Homoscédasticité
plot(best_model, which = 2, main = "Q-Q Plot", col = 'red',  pch = 4) # Normalité
par(mfrow = c(1, 1))
plot(best_model, which = 4, main = "Distance de Cook", col = 'blue')
abline(0.03, 0, col = "red", lty = 2)
par(mfrow = c(1, 2))
plot(best_model, which = 4, main = "Distance de Cook", col = 'blue')
abline(0.03, 0, col = "red", lty = 2)
plot(best_model, which = 5, main = "Résidus vs Levier")
par(mfrow = c(1, 1))
par(mfrow = c(1, 2))
plot(best_model, which = 4, main = "Distance de Cook", col = 'blue')
abline(0.03, 0, col = "red", lty = 2)
plot(best_model, which = 5, main = "Résidus vs Levier", col = 'red',  pch = 4)
par(mfrow = c(1, 1))
